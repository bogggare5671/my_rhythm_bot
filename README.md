# Rhythm-Bot

–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è —Ä–∏—Ç–º-–∏–≥—Ä–∞ –Ω–∞ Orange Pi + Arduino UNO —Å I¬≤C-LCD –∏ LED-–∫–Ω–æ–ø–∫–∞–º–∏.

---

## üìú –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞](#–æ–ø–∏—Å–∞–Ω–∏–µ-–ø—Ä–æ–µ–∫—Ç–∞)  
2. [–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª](#—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª)  
3. [–ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è —á–∞—Å—Ç—å](#–∞–ø–ø–∞—Ä–∞—Ç–Ω–∞—è-—á–∞—Å—Ç—å)  
4. [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–∑–∞–ø—É—Å–∫)  
5. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è)  
6. [–û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤](#–æ–ø–∏—Å–∞–Ω–∏–µ-—Ñ–∞–π–ª–æ–≤)  
7. [–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è](#–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è)  
8. [–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –≤–∫–ª–∞–¥](#—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞-–∏-–≤–∫–ª–∞–¥)

---

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

Rhythm-Bot ‚Äî —ç—Ç–æ –æ–±—É—á–∞—é—â–∞—è –∏–≥—Ä–∞ –Ω–∞ —Ä–∞–∑–≤–∏—Ç–∏–µ —Ä–∏—Ç–º–∏—á–µ—Å–∫–æ–≥–æ —Å–ª—É—Ö–∞.  
Orange Pi –≤—ã–≤–æ–¥–∏—Ç –Ω–∞ Arduino –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å LED-–º–∏–≥–∞–Ω–∏–π (–ø–∞—Ç—Ç–µ—Ä–Ω) –∏ –∑–≤—É–∫–æ–≤, –∏–≥—Ä–æ–∫ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –∫–æ–º–±–∏–Ω–∞—Ü–∏—é –Ω–∞ –∫–Ω–æ–ø–∫–∞—Ö. –ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–∏ ‚Äî –≤—ã–¥–∞—ë—Ç—Å—è ¬´–ø—Ä–∏–∑¬ª (—Å–µ—Ä–≤–æ–ø—Ä–∏–≤–æ–¥) –∏ –≤—ã–≤–æ–¥–∏—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ I¬≤C-LCD.

---

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

- üéµ –ü—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏–µ –∑–≤—É–∫–æ–≤ (Kick, Snare, Hihat –∏ –¥—Ä.) —á–µ—Ä–µ–∑ I¬≤S-—É—Å–∏–ª–∏—Ç–µ–ª—å MAX98357A.  
- üí° –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Ç—Ä—ë—Ö –∫–Ω–æ–ø–æ–∫ —Å–≤–µ—Ç–æ–¥–∏–æ–¥–∞–º–∏, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤–≤–æ–¥–∞ –≤–æ –≤—Ä–µ–º—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏.  
- üî¢ –ü—Ä–µ–¥–∑–∞–¥–∞–Ω–Ω–∞—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å ¬´—É—Ä–æ–≤–Ω–µ–π¬ª –≤ JSON (`levels.json`), –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –ø–∞—Ç—Ç–µ—Ä–Ω–∞.  
- ‚è± –¢–∞–π–º–∞—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è –≤–≤–æ–¥–∞ –∏ –¥–æ–ø—É—Å–∫ –ø–æ —Ç–∞–π–º–∏–Ω–≥—É (¬±20% –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é).  
- üñ• –í—ã–≤–æ–¥ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞ 16√ó2 I¬≤C-LCD —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∫–∏—Ä–∏–ª–ª–∏—Ü—ã.  
- üõ† –£—Ç–∏–ª–∏—Ç–∞ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —É—Ä–æ–≤–Ω–µ–π (`level_editor_full.py`).  
- üîÑ –°–∫–≤–æ–∑–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ –º–æ–¥—É–ª–∏:  
  - `serial_io.py` ‚Äî –Ω–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–æ–µ –æ–±—â–µ–Ω–∏–µ –ø–æ UART  
  - `lcd.py` ‚Äî –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è UTF-8 ‚Üí CP1251 + –≤—ã–≤–æ–¥ –Ω–∞ –¥–∏—Å–ø–ª–µ–π  
  - `audio.py` ‚Äî –ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏–µ –∑–≤—É–∫–æ–≤ –∏ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è/–æ—á–∏—Å—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤  
  - `engine.py` ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è –∏–≥—Ä–æ–≤–∞—è –ª–æ–≥–∏–∫–∞  
- üéÅ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–æ–ø—Ä–∏–≤–æ–¥–æ–º –¥–ª—è –≤—ã–¥–∞—á–∏ –ø—Ä–∏–∑–∞.  

---

## –ê–ø–ø–∞—Ä–∞—Ç–Ω–∞—è —á–∞—Å—Ç—å

- **Orange Pi** (H3)  
  - TX/RX ‚Üí Arduino –ø–æ UART  
  - I¬≤C (SDA/SCL) ‚Üí 16√ó2 LCD  
  - I¬≤S (BCLK, LRCK, DATA) ‚Üí MAX98357A ‚Üí –∫–æ–ª–æ–Ω–∫–∏  
- **Arduino UNO**  
  - D2‚ÄìD4 ‚Üê –∫–Ω–æ–ø–∫–∏ (INPUT_PULLUP)  
  - D5‚ÄìD7 ‚Üí —Å–≤–µ—Ç–æ–¥–∏–æ–¥—ã  
  - D8 ‚Üê –∫–Ω–æ–ø–∫–∞ RESET/START  
  - D9 ‚Üí —Å–µ—Ä–≤–æ (–ø—Ä–∏–∑)  
  - A4/A5 ‚Üí I¬≤C (LCD)  

–°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ –≤ [docs/hardware.md](docs/hardware.md).

---

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π**  
   ```bash
   git clone https://github.com/–≤–∞—à-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å/rhythm-bot.git
   cd rhythm-bot
–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –Ω–∞ Orange Pi

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
sudo apt update
sudo apt install python3-serial python3-pip aplay sox
pip3 install -r requirements.txt
–ü—Ä–æ—à–∏—Ç—å Arduino

–û—Ç–∫—Ä–æ–π—Ç–µ my_rhythm_bot.ino –≤ Arduino IDE

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–∏–±–ª–∏–æ—Ç–µ–∫—É LiquidCrystal_I2C_Cyrillic

–ó–∞–≥—Ä—É–∑–∏—Ç–µ –Ω–∞ –ø–ª–∞—Ç—É (COM-–ø–æ—Ä—Ç /dev/ttyUSB0, –ø–ª–∞—Ç–∞ Arduino UNO)

–ó–∞–ø—É—Å—Ç–∏—Ç—å –∏–≥—Ä—É

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
python3 -m game.engine
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
.
‚îú‚îÄ‚îÄ deploy.sh               # —Å–∫—Ä–∏–ø—Ç —Å–±–æ—Ä–∫–∏ –∏ –ø—Ä–æ—à–∏–≤–∫–∏ Arduino
‚îú‚îÄ‚îÄ levels.json             # JSON-—Ñ–∞–π–ª —Å —É—Ä–æ–≤–Ω—è–º–∏
‚îú‚îÄ‚îÄ play_sound_clean.py     # —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏/–ø—Ä–æ–∏–≥—Ä—ã–≤–∞–Ω–∏—è –∑–≤—É–∫–æ–≤
‚îú‚îÄ‚îÄ requirements.txt        # Python-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ sounds/                 # –ø–∞–ø–∫–∞ —Å–æ –∑–≤—É–∫–æ–≤—ã–º–∏ —Ñ–∞–π–ª–∞–º–∏ (.wav)
‚îú‚îÄ‚îÄ game/                   # –æ—Å–Ω–æ–≤–Ω–æ–π Python-–ø–∞–∫–µ—Ç
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ config.py           # –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ –ø—É—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ serial_io.py        # UART-—É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ lcd.py              # –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä –∏ –≤—ã–≤–æ–¥ –Ω–∞ LCD
‚îÇ   ‚îú‚îÄ‚îÄ audio.py            # play_sound –∏ —Ç–µ—Å—Ç–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ engine.py           # main-loop –∏–≥—Ä–æ–≤–æ–π –ª–æ–≥–∏–∫–∏
‚îú‚îÄ‚îÄ level_editor_full.py    # —Ä–µ–¥–∞–∫—Ç–æ—Ä —É—Ä–æ–≤–Ω–µ–π (CLI)
‚îú‚îÄ‚îÄ my_rhythm_bot.ino       # Arduino-—Å–∫–µ—Ç—á
‚îî‚îÄ‚îÄ README.md
–û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤
deploy.sh ‚Äî —Å–æ–±–∏—Ä–∞–µ—Ç –∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Å–∫–µ—Ç—á –≤ Arduino –ø–æ arduino-cli.

levels.json ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞: —Å–ø–∏—Å–æ–∫ —É—Ä–æ–≤–Ω–µ–π, –∫–∞–∂–¥—ã–π —Å –Ω–∞–±–æ—Ä–æ–º –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ–º –∫–Ω–æ–ø–∫–∞‚Üí–∑–≤—É–∫.

play_sound_clean.py ‚Äî –Ω–∞ –ª–µ—Ç—É –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç WAV, –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –≤ S16_LE, Mono –∏ —É–¥–∞–ª—è–µ—Ç —Å—Ç–∞—Ä—ã–µ —Ñ–∞–π–ª—ã.

game/config.py ‚Äî –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–ø—É—Ç–∏, –ø–æ—Ä—Ç—ã, —Ç–∞–π–º–∞—É—Ç—ã, –¥–æ–ø—É—Å–∫–∏).

game/serial_io.py ‚Äî –∫–ª–∞—Å—Å SerialIO + —Ñ—É–Ω–∫—Ü–∏–∏-–æ–±—ë—Ä—Ç–∫–∏ –¥–ª—è –∫–æ–º–∞–Ω–¥ Arduino (SHOW, LED OFF, LCD, BLOCK/ALLOW_INPUT, PRIZE).

game/lcd.py ‚Äî rus_to_lcd() + lcd(text) ‚Äî –ø—Ä–µ–æ–±—Ä–∞–∂–µ–Ω–∏–µ UTF-8 ‚Üí –±–∞–π—Ç—ã LiquidCrystal –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞.

game/audio.py ‚Äî process_and_play() —á–µ—Ä–µ–∑ sox/aplay, –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ñ–æ–Ω–∞ –∏ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤.

game/engine.py ‚Äî –≥–ª–∞–≤–Ω—ã–π —Ü–∏–∫–ª:

wait_for_start()

–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø–∞—Ç—Ç–µ—Ä–Ω–∞ (show_pattern)

–ß—Ç–µ–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–≤–æ–¥–∞ (wait_for_input)

–ó–≤—É–∫–æ–≤–æ–π/–≤–∏–∑—É–∞–ª—å–Ω—ã–π —Ñ–∏–¥–±—ç–∫, –ø–µ—Ä–µ—Ö–æ–¥ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å –∏–ª–∏ —Å–±—Ä–æ—Å

level_editor_full.py ‚Äî —É–¥–æ–±–Ω—ã–π CLI-—Ä–µ–¥–∞–∫—Ç–æ—Ä levels.json:

–≤—ã–±–æ—Ä –∑–≤—É–∫–æ–≤ –∏–∑ –ø–∞–ø–∫–∏

—Ä—É—á–Ω–æ–π –≤–≤–æ–¥ –∏–ª–∏ –∑–∞–ø–∏—Å—å –ø–∞—Ç—Ç–µ—Ä–Ω–∞ —Å –ø–ª–∞—Ç—ã

—É–¥–∞–ª–µ–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ø–æ –∏–Ω–¥–µ–∫—Å—É

my_rhythm_bot.ino ‚Äî Arduino UNO sketch:

UART-–ø—Ä–æ—Ç–æ–∫–æ–ª: SHOW n, LED OFF n, ALLOW_INPUT, BLOCK_INPUT, LCD <bytes>, PRIZE

–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ LED, –∫–Ω–æ–ø–∫–∞–º–∏, —Å–µ—Ä–≤–æ, I¬≤C-LCD —Å –∫–∏—Ä–∏–ª–ª–∏—Ü–µ–π

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
–í—Å–µ –ø—É—Ç–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ game/config.py:

–ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞	–û–ø–∏—Å–∞–Ω–∏–µ	–ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
LEVELS_PATH	–ø—É—Ç—å –∫ JSON —É—Ä–æ–≤–Ω—è–º	/root/my_rhythm_bot/levels.json
SOUND_FOLDER	–ø–∞–ø–∫–∞ —Å–æ –∑–≤—É–∫–∞–º–∏	/root/my_rhythm_bot/sounds
SERIAL_PORT	UART-–ø–æ—Ä—Ç –¥–ª—è Arduino	/dev/ttyUSB0
BAUDRATE	—Å–∫–æ—Ä–æ—Å—Ç—å UART	9600
TIMEOUT_SECONDS	—Ç–∞–π–º–∞—É—Ç –æ–∂–∏–¥–∞–Ω–∏—è –≤–≤–æ–¥–∞ (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö)	20
TIMING_TOLERANCE	–¥–æ–ø—É—Å–∫ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ (–¥–æ–ª—è ¬±)	1.5 (= ¬±50%)
SESSION_LIMIT	–ª–∏–º–∏—Ç –≤—Ä–µ–º–µ–Ω–∏ –≤—Å–µ–π –∏–≥—Ä–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ (—Å)	300 (= 5 –º–∏–Ω)
AFTER_LEVEL_PAUSE	–ø–∞—É–∑–∞ –ø–æ—Å–ª–µ –∑–≤—É–∫–∞ —Ñ–∏–¥–±—ç–∫–∞ (—Å)	2

–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –≤–∫–ª–∞–¥
–°–æ–∑–¥–∞–π—Ç–µ —Ñ–æ—Ä–∫ –∏ –≤–µ—Ç–∫—É:

bash
–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
git checkout -b feature/awesome
–í–Ω–µ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏–≥—Ä–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∏ —É—Ä–æ–≤–µ–Ω—å –ø—Ä–æ—Ö–æ–¥–∏–º.

–ù–∞–ø–∏—à–∏—Ç–µ —Ç–µ—Å—Ç—ã (–ø—Ä–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏) –¥–ª—è –Ω–æ–≤—ã—Ö –º–æ–¥—É–ª–µ–π.

–û—Ñ–æ—Ä–º–∏—Ç–µ PR —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º, —á—Ç–æ –¥–æ–±–∞–≤–∏–ª–æ—Å—å/–∏—Å–ø—Ä–∞–≤–∏–ª–æ—Å—å.

–°–ø–∞—Å–∏–±–æ –∑–∞ –∏–Ω—Ç–µ—Ä–µ—Å –∫ –ø—Ä–æ–µ–∫—Ç—É!
–ë—É–¥—É —Ä–∞–¥ –≤–∞—à–∏–º –∑–≤—É–∫–∞–º, –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º –∏ –≤–∫–ª–∞–¥–∫–∞–º –≤ —É—Ä–æ–≤–Ω–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞. üé∂
